本章旨在介绍基本的密码学知识，从区块链整体框架来看，通过本章可以了解到如何在节点间建立一个安全的物理连接，保证节点间数据可信的传输，这也是区块链信任机器最基本的基石，同时本章知识也为后面章节涉及密码学相关的技术作为铺垫。

### 基本元素
- 明文M：原始数据，待加密的数据；
- 密文C：对明文M进行一定变换或伪装后的输出；
- 密钥K：加密或解密中所使用的专门工具；
- 加密E：将明文M，通过密钥K变换得到密文C的过程；
- 解密D：将密文还原成明文M的过程；

### 对称加密
对称加密是指进行明文到密文加密和密文到明文解密时使用相同的秘钥，对称加密的安全性依赖于加密算法的安全性和秘钥的长度。

![Alt text](https://github.com/Ice-Storm/structure-and-interpretation-of-blockchain/blob/master/img/1.png?raw=true)

优点：算法公开，速度快，保密强度高，占用空间小；
缺点：秘钥的分发和管理比较复杂；
用途：大量数据的加密；
代表算法：DES，AES；
问题：在没有建立安全信道之前，秘钥无法实现安全的交换；

### 非对称加密
非对称加密是指进行明文到密文加密和密文到明文解密时使用不同的秘钥，每个用户都有一对秘钥，一个用于加密，一个用于解密，其中加密秘钥可以公开，称之为公钥（Public Key），解密秘钥需要严格保存不能公开，称之为私钥（Private Key）。

![Alt text](https://github.com/Ice-Storm/structure-and-interpretation-of-blockchain/blob/master/img/2.png?raw=true)


优点：通信双方不需要通过建立一个安全的信道来进行秘钥的交换，降低了秘钥管理的难度；
缺点：加解密速度慢于对称加密，不适合大量数据的加解密；
用途：加密关键性的，核心数据；
代表算法：RSA，椭圆曲线算法;
问题：因为公钥公开，如果有人用公钥加密数据发送给我，是无法判断发送者是谁的；使用私钥加密的数据，可以使用公钥解密；

### 混合加密
混合加密同时使用了对称加密和非对称加密方法，对称加密的一个很大问题是通信双方如何将秘钥传输给对方，为了安全，一般采用带外传输，也就是说如果加密通信是在网络中，那么秘钥的传输就需要通过其他途径，如邮件，短信，即使如此也很难保证秘钥传输的安全性。
非对称加解密的最大优点是事先不需要传输秘钥，但是速度慢，因此实际应用中，通常采用混合密码体制。

### 消息摘要
哈希（Hash）函数也被称为散列函数，它能够对不同长度的输入信息，产生定长的输出，定长的输出被称为消息散列或者消息摘要。

散列算法：散列算法就是产生信息散列值的算法，它有一个特性，就是在输入信息中如果发生细微的改变，比如给变了二进制的一位，都可以改变散列值中每个比特的特性，导致最后的输出结果大相径庭，所以它对于检测消息或者密钥等信息对象中的任何微小的变化非常有用。

1、输入长度是任意的，输出是固定的

2、对每一个给定的输入,计算输出是很容易的

3、给定H,找到两个不同的输入，输出同一个值在计算上不可行

4、给定H和一个消息x,找到另一个不同的消息y，使它们散列到同一个值在计算上不可行

常见的散列算法：MD5、SHA、SHA-256、SHA-512

### 数字签名
数字签名是指发送以电子形式签名一个消息或文件，签名后的消息表示签名人对该消息的内容负责。数字签名使用了消息摘要和非对称加密技术，可以保证接受者能够核实发送者对消息的签名，发送者事后不能抵赖对消息的签名，接受者不能篡改报文内容和伪造对报文的签名。

通过数字签名可以确保两点；
- 确认信息是由签名者发送；
- 确认信息从签发到接受没有被修改过，包括传输中的中间人修改。

数字签名的过程：
- 发送方要发送消息运用散列函数（MD5、SHA-1等）形成消息摘要；
- 发送方用自己的私钥对消息摘要进行加密，形成数字签名；
- 发送方将数字签名附加在消息后发送给接收方；
- 接受方用发送方的公钥对签名信息进行解密，得到消息摘要；
- 接收方以相同的散列函数对接收到的消息进行散列，也得到一份消息摘要；
- 接收方比较两个消息摘要，如果完全一致，说明数据没有被篡改，签名真实有效；否则拒绝该签名。

这个过程中也有一些问题，比如发送的消息是明文的，如果要发送密文显然采用这种方式是不合适的，对消息不仅要生成摘要，还需要的消息本身进行加密。
- 发送方要发送消息运用散列函数（MD5、SHA-1等）形成消息摘要；
- 发送方用自己的私钥对消息摘要进行加密，形成数字签名；
- 发送方用对称加密算法对消息原文、数字签名进行加密，得到密文信息；
- 发送方用接收方的公钥加密对称加密算法的密钥进行加密，形成数字信封；
- 发送方将3中的密文信息和数字信封一起发给接收方；
- 接收方首先用自己的私钥解密数字信封，还原对称加密算法的密钥；
- 接受方用6中的密钥解密接收到的密文，得到原文信息和数字签名；
- 接受方用发送方的公钥对签名信息进行解密，得到消息摘要；
- 接收方以相同的散列函数对接收到的消息进行散列，也得到一份消息摘要；
- 接收方比较两个消息摘要，如果完全一致，说明数据没有被篡改，签名真实有效；否则拒绝该签名。

### 数字证书
数字证书是一种权威的电子证明，由权威公正的第三方认证机构（CA）签发，广泛用于涉及需要身份认证和数据安全的领域。

数字证书主要用来保证信息保密、身份确认、不可否认性、数据完整性，常见的格式是`X.509`。

区块链中在节点间安全通行，身份认证，智能合约，共识算法模块中都大量使用到了上述算法。
