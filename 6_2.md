# MPT树

为了解决数据变更需要计算全量哈希和乱序数据默克尔证明不一致的问题，引入了一种新的数据结构MPT树。

## 字典树（Trie）

Trie又称前缀树或字典树，是一种有序多叉树。下图是一颗典型的前缀树；

![](https://github.com/Ice-Storm/structure-and-interpretation-of-blockchain/blob/master/img/chapter_6/6_3.png?raw=true)

图中前缀树存储了一些字符串，蓝色的是关键字，存储的字符串由关键字组成。存储了"a", "to", "tea", "ted", "ten", "i", "in", "inn"。
前缀树有这些特点；
- 根节点不包含字符，其他节点各包含一个字符；
- 关键路径节点的字符连接起来为该节点所存储的数据；

> 关键路径就是每个节点有一个标志位，用来标记这个节点是否作为构成数据的一部分，上图中的，t, e 节点就不是关键路径。

Trie的核心思想就是用空间换时间，利用公共前缀缩小要比较的范围来达到快速查找的目的。

##### 优点

- 插入和查询的效率都很高，都是O(m)，m是插入或查询字符串的长度。
- 可以对数据按照字典序排序。

##### 缺点

- 空间消耗的比较大。

##### 典型场景

- 但词频次统计。
- 字符串匹配。
- 字符串字典序排序。
- 前缀匹配，比如一些搜索框的自动提示。

### 压缩字典树

压缩字典树在字典树的基础之上做了一些优化，具体可以看下图；

![](https://github.com/Ice-Storm/structure-and-interpretation-of-blockchain/blob/master/img/chapter_6/6_4.png?raw=true)

图中黑色的是关键路径，存储了字符串"abc"和"d"，但是明显可以看到压缩后的前缀树占用了更小的空间。